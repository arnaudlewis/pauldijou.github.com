---
title: "JSF, Bootstrap and calling render=@all"
authors: [pauldijou]
layout: post
summary: 0
tags: [jsf, bootstrap]
---
h3. The problem

So, the other day, I was playing with "Twitter Bootstrap":http://twitter.github.com/bootstrap/index.html on a JSF application. Everything was fine until I decide to use a <code>render="@all"</code> somewhere in the page in order to refresh all my components after quite an heavy operation. Working fine.

But Bootstrap was no longuer fully healthy. The CSS and design were ok, but the Javascript was all broken : nearly all effects didn't appear anymore. It was a bit strange so I hit F5 and everything was fine, all Javascript events were back. But the moment my <code>render="@all"</code> was called, they dissapear again.

h3. Why?

After some investigations, the reason was that Bootstrap calls a Javascript function that will attach most of its events to the @<body>@ when the HTML DOM is ready. Its doing so in order to catch all user interactions when they bubble up to the @<body>@ tag which wrap the whole page. With that, you can use Ajax as much as you want and update your DOM since there is no event attach to a particular HTML tag, they are all in the @<body>@ tag.

That's really good but that's also the reason of the problem. I said Ajax is always fine, and it's true as long as you don't touch the @<body>@ tag. The moment you update this tag, it will probably be reset to it's initial state, without any Javascript event, and since the Bootstrap Javascript function is only called once when the DOM is ready the first time, Javascript events will not come back. Guess what, <code>render="@all"</code> will render your @<h:body>@ and so will broke all Bootstrap Javascipt events.

h3. A workaround

The true solution would be to call the Bootstrap Javascript function after each <code>render="@all"</code> in order to attach all Javascript events again. But since I have no idea how to do that right now, I have choosen to use an easier workaround.

Just wrapping your whole page in a JSF panel and render it instead of <code>render="@all"</code> should be enough in most use case. It is not exactly the same behaviour, but in most case, when calling <code>render="@all"</code>, what you really want is just refreshing your whole page using Ajax. For example:

bc(prettyprint linenums).. <!DOCTYPE html>
<html lang="en-US"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
<h:head>
    <title>Site title</title>
</h:head>
<h:body>
    <h:panelGroup id="all">
        ... your code...
    </h:panelGroup>
</h:body>
</html>

p. And replace all your <code>render="@all"</code> with @render="all"@.